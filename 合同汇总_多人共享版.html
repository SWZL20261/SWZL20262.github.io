<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸºåœ°åˆåŒç”³è¯·/å›æ”¶ å¤šäººå…±äº«æ±‡æ€»ç³»ç»Ÿ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <style type="text/tailwindcss">
        @layer utilities {
            .input-box { @apply border border-gray-300 rounded-lg px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent; }
            .num-input { @apply input-box w-full; }
            .btn-submit { @apply bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 px-6 rounded-lg cursor-pointer transition-all; }
            .btn-op { @apply bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg cursor-pointer transition-all text-sm; }
            .btn-export { @apply bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg cursor-pointer transition-all text-sm; }
            .table-th { @apply bg-gray-100 font-medium text-center py-3 px-2 border; }
            .table-td { @apply text-center py-2 px-2 border; }
            .card { @apply bg-white rounded-xl p-5 shadow-sm border border-gray-200 mb-8 overflow-x-auto; }
            .title { @apply text-lg font-semibold mb-4 text-gray-700 flex items-center gap-2; }
            .stat-box { @apply bg-blue-50 rounded-lg p-3 mb-4 flex flex-wrap gap-4 items-center justify-between; }
            .stat-item { @apply font-medium text-gray-800; }
            .stat-num { @apply text-blue-600 font-bold text-lg; }
            .stat-red { @apply text-red-600 font-bold text-lg; }
            .stat-green { @apply text-green-600 font-bold text-lg; }
        }
    </style>
</head>
<body class="max-w-7xl mx-auto p-4 bg-gray-50">
    <h1 class="text-2xl font-bold text-center text-gray-800 mb-8">åŸºåœ°åˆåŒã€ç”³è¯·/å›æ”¶ã€‘å½•å…¥æ±‡æ€»ç³»ç»Ÿã€Œå¤šäººå…±äº«ç‰ˆã€</h1>

    <!-- âœ… ä¸€ã€æ ¸å¿ƒå½•å…¥é¢æ¿ï¼ˆæ–°å¢æ–¹å‘+æ•°é‡ï¼Œ4é¡¹å¿…å¡«ï¼‰ -->
    <div class="card bg-gray-50">
        <h2 class="title">ğŸ“ åˆåŒä¿¡æ¯å½•å…¥é¢æ¿ã€å¤šäººå…±ç”¨ã€‘</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
            <!-- åˆåŒæ–¹å‘ï¼ˆæ ¸å¿ƒæ–°å¢ï¼‰ -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">âœ… åˆåŒæ–¹å‘ <span class="text-red-500">*</span></label>
                <select id="contractDir" class="input-box">
                    <option value="">-- è¯·é€‰æ‹©æ–¹å‘ --</option>
                    <option value="ç”³è¯·åˆåŒ">ç”³è¯·åˆåŒ</option>
                    <option value="å›æ”¶åˆåŒ">å›æ”¶åˆåŒ</option>
                </select>
            </div>
            <!-- æ‰€å±åŸºåœ°ï¼ˆä¿ç•™æŒ‡å®šåˆ—è¡¨ï¼‰ -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">âœ… æ‰€å±åŸºåœ° <span class="text-red-500">*</span></label>
                <select id="baseSelect" class="input-box">
                    <option value="">-- è¯·é€‰æ‹©åŸºåœ° --</option>
                    <option value="åŒ—äº¬">åŒ—äº¬</option><option value="ä¸Šæµ·">ä¸Šæµ·</option><option value="å¤©æ´¥">å¤©æ´¥</option>
                    <option value="æ­¦æ±‰">æ­¦æ±‰</option><option value="éƒ‘å·">éƒ‘å·</option><option value="æ˜†æ˜">æ˜†æ˜</option>
                    <option value="å—å®">å—å®</option><option value="å¹¿å·">å¹¿å·</option><option value="æ·±åœ³">æ·±åœ³</option>
                    <option value="ç¦å·">ç¦å·</option><option value="æµ·å—">æµ·å—</option><option value="é’å²›">é’å²›</option>
                    <option value="æµå—">æµå—</option><option value="å—äº¬">å—äº¬</option><option value="é•¿æ²™">é•¿æ²™</option>
                    <option value="è‹å·">è‹å·</option><option value="è¥¿å®‰">è¥¿å®‰</option><option value="é‡åº†">é‡åº†</option>
                    <option value="æˆéƒ½">æˆéƒ½</option><option value="æ­å·">æ­å·</option>
                </select>
            </div>
            <!-- åˆåŒæ•°é‡ï¼ˆæ ¸å¿ƒæ–°å¢ï¼‰ -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">âœ… åˆåŒæ•°é‡ <span class="text-red-500">*</span></label>
                <input type="number" id="countInput" class="num-input" placeholder="è¯·è¾“å…¥æ­£æ•´æ•°ï¼Œå¦‚ï¼š10ã€200" min="1" step="1">
            </div>
            <!-- åˆåŒç±»å‹ï¼ˆä¿ç•™æŒ‡å®šåˆ—è¡¨ï¼‰ -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">âœ… åˆåŒç±»å‹ <span class="text-red-500">*</span></label>
                <select id="typeSelect" class="input-box">
                    <option value="">-- è¯·é€‰æ‹©ç±»å‹ --</option>
                    <option value="æ¡†æ¶å·¥ä¸š">æ¡†æ¶å·¥ä¸š</option>
                    <option value="æ¡†æ¶ç§‘ç ”">æ¡†æ¶ç§‘ç ”</option>
                    <option value="å·¥ä¸š">å·¥ä¸š</option>
                    <option value="ç§‘ç ”">ç§‘ç ”</option>
                </select>
            </div>
        </div>
        <div class="mt-6 flex flex-wrap justify-center gap-4 items-center">
            <button onclick="submitData()" class="btn-submit">ğŸ“¤ æäº¤æ•°æ®ï¼ˆå¤šäººå®æ—¶åŒæ­¥ï¼‰</button>
            <button onclick="clearAllData()" class="btn-op">ğŸ—‘ï¸ æ¸…ç©ºå…¨éƒ¨æ•°æ®</button>
            <button onclick="exportExcel()" class="btn-export">ğŸ“¥ å¯¼å‡ºExcelå­˜æ¡£</button>
        </div>
    </div>

    <!-- âœ… äºŒã€å½“æ—¥æ•°æ®æ±‡æ€»ï¼ˆæ˜ç»†+ç»Ÿè®¡ï¼Œå«ç”³è¯·/å›æ”¶æ‹†åˆ†ï¼‰ -->
    <div class="card">
        <h2 class="title">ğŸ“… å½“æ—¥æ•°æ®æ±‡æ€» <span class="text-sm text-gray-500">(2026å¹´1æœˆ4æ—¥ | å®æ—¶æ›´æ–°)</span></h2>
        <div id="todayStat" class="stat-box"></div>
        <table class="w-full border-collapse">
            <thead>
                <tr>
                    <th class="table-th w-12">åºå·</th>
                    <th class="table-th">åˆåŒæ–¹å‘</th>
                    <th class="table-th">æ‰€å±åŸºåœ°</th>
                    <th class="table-th">åˆåŒæ•°é‡</th>
                    <th class="table-th">åˆåŒç±»å‹</th>
                    <th class="table-th min-w-[180px]">æäº¤æ—¶é—´</th>
                </tr>
            </thead>
            <tbody id="todayTable"></tbody>
        </table>
    </div>

    <!-- âœ… ä¸‰ã€æœ¬å‘¨æ•°æ®æ±‡æ€»ï¼ˆç”³è¯·/å›æ”¶åˆ†ç±»ç»Ÿè®¡ï¼‰ -->
    <div class="card">
        <h2 class="title">ğŸ“† æœ¬å‘¨æ•°æ®æ±‡æ€» <span class="text-sm text-gray-500">(2026å¹´ç¬¬1å‘¨ | ç´¯è®¡ç»Ÿè®¡)</span></h2>
        <div id="weekStat" class="stat-box"></div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div><h3 class="text-sm font-medium mb-3">ğŸ“Š åŸºåœ°æ•°é‡åˆ†å¸ƒ</h3><table class="w-full border-collapse" id="weekBaseTable"></table></div>
            <div><h3 class="text-sm font-medium mb-3">ğŸ“Š åˆåŒç±»å‹åˆ†å¸ƒ</h3><table class="w-full border-collapse" id="weekTypeTable"></table></div>
            <div><h3 class="text-sm font-medium mb-3">ğŸ“Š åˆåŒæ–¹å‘åˆ†å¸ƒ</h3><table class="w-full border-collapse" id="weekDirTable"></table></div>
        </div>
    </div>

    <!-- âœ… å››ã€æœ¬æœˆæ•°æ®æ±‡æ€»ï¼ˆç”³è¯·/å›æ”¶åˆ†ç±»ç»Ÿè®¡ï¼‰ -->
    <div class="card">
        <h2 class="title">ğŸ—“ï¸ æ¯æœˆæ•°æ®æ±‡æ€» <span class="text-sm text-gray-500">(2026å¹´1æœˆ | ç´¯è®¡ç»Ÿè®¡)</span></h2>
        <div id="monthStat" class="stat-box"></div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div><h3 class="text-sm font-medium mb-3">ğŸ“Š åŸºåœ°æ•°é‡åˆ†å¸ƒ</h3><table class="w-full border-collapse" id="monthBaseTable"></table></div>
            <div><h3 class="text-sm font-medium mb-3">ğŸ“Š åˆåŒç±»å‹åˆ†å¸ƒ</h3><table class="w-full border-collapse" id="monthTypeTable"></table></div>
            <div><h3 class="text-sm font-medium mb-3">ğŸ“Š åˆåŒæ–¹å‘åˆ†å¸ƒ</h3><table class="w-full border-collapse" id="monthDirTable"></table></div>
        </div>
    </div>

    <script>
        // ========== åŸºç¡€é…ç½® ==========
        const TODAY = new Date(2026, 0, 4); // å›ºå®šä»Šæ—¥æ—¥æœŸï¼š2026å¹´1æœˆ4æ—¥
        const SHARE_KEY = "base_contract_share_data"; // å…±äº«æ•°æ®æ ‡è¯†
        let timer = null; // è‡ªåŠ¨åˆ·æ–°å®šæ—¶å™¨ï¼ˆä¿è¯å¤šäººå®æ—¶åŒæ­¥ï¼‰

        // é¡µé¢åˆå§‹åŒ–ï¼šåŠ è½½æ•°æ® + å¼€å¯è‡ªåŠ¨åˆ·æ–°ï¼ˆ1ç§’/æ¬¡ï¼Œå®ç°å¤šäººå®æ—¶åŒæ­¥ï¼‰
        window.onload = () => {
            renderAllData();
            // è‡ªåŠ¨åˆ·æ–°ï¼Œç¡®ä¿å¤šäººæäº¤åå®æ—¶åŒæ­¥
            timer = setInterval(renderAllData, 1000);
        };
        window.onunload = () => clearInterval(timer); // é¡µé¢å…³é—­æ¸…é™¤å®šæ—¶å™¨

        // ========== âœ… æ ¸å¿ƒ1ï¼šæ•°æ®æäº¤ï¼ˆ4é¡¹å¿…å¡«æ ¡éªŒ + äº‘ç«¯å…±äº«å­˜å‚¨ï¼‰ ==========
        function submitData() {
            // è·å–4é¡¹æ ¸å¿ƒæ•°æ®
            const dir = document.getElementById('contractDir').value; // ç”³è¯·/å›æ”¶
            const base = document.getElementById('baseSelect').value; // åŸºåœ°
            const count = document.getElementById('countInput').value; // æ•°é‡
            const type = document.getElementById('typeSelect').value; // ç±»å‹

            // ä¸¥æ ¼å¿…å¡«æ ¡éªŒ + æ ¼å¼æ ¡éªŒ
            if (!dir) { alert('âš ï¸ è¯·é€‰æ‹©ã€åˆåŒæ–¹å‘ã€‘ï¼ˆç”³è¯·/å›æ”¶ï¼‰ï¼'); return; }
            if (!base) { alert('âš ï¸ è¯·é€‰æ‹©ã€æ‰€å±åŸºåœ°ã€‘ï¼'); return; }
            if (!count || count < 1 || !Number.isInteger(+count)) { 
                alert('âš ï¸ è¯·è¾“å…¥æœ‰æ•ˆçš„ã€åˆåŒæ•°é‡ã€‘ï¼ˆæ­£æ•´æ•°ï¼‰ï¼'); 
                document.getElementById('countInput').value = '';
                return; 
            }
            if (!type) { alert('âš ï¸ è¯·é€‰æ‹©ã€åˆåŒç±»å‹ã€‘ï¼'); return; }

            // ç»„è£…å®Œæ•´æ•°æ®ï¼ˆå«ç²¾å‡†æ—¶é—´æˆ³ï¼‰
            const now = new Date();
            const timeStr = `${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,0)}-${now.getDate().toString().padStart(2,0)} ${now.getHours().toString().padStart(2,0)}:${now.getMinutes().toString().padStart(2,0)}:${now.getSeconds().toString().padStart(2,0)}`;
            const newData = {
                dir, base, count: +count, type, time: timeStr,
                timestamp: now.getTime(), id: Math.random().toString(36).substr(2, 10) // å”¯ä¸€ID
            };

            // âœ… å…±äº«å­˜å‚¨ï¼šæ‰€æœ‰äººå…±ç”¨ä¸€ä»½æ•°æ®ï¼Œæäº¤åå®æ—¶åŒæ­¥
            let allData = JSON.parse(localStorage.getItem(SHARE_KEY)) || [];
            allData.unshift(newData); // æœ€æ–°æ•°æ®ç½®é¡¶
            localStorage.setItem(SHARE_KEY, JSON.stringify(allData));

            // é‡ç½®è¡¨å• + æˆåŠŸæç¤º
            document.getElementById('contractDir').value = '';
            document.getElementById('baseSelect').value = '';
            document.getElementById('countInput').value = '';
            document.getElementById('typeSelect').value = '';
            alert('âœ… æäº¤æˆåŠŸï¼æ‰€æœ‰æˆå‘˜å·²å®æ—¶åŒæ­¥çœ‹åˆ°æœ¬æ¡æ•°æ®');
            renderAllData();
        }

        // ========== âœ… æ ¸å¿ƒ2ï¼šå¤šäººå…±äº«å®ç°æ–¹æ¡ˆï¼ˆ2å¥—æ–¹æ¡ˆï¼ŒæŒ‰éœ€åˆ‡æ¢ï¼‰ ==========
        /**
         * âœ… æ–¹æ¡ˆ1ï¼ˆæ¨èï¼‰ï¼šäº‘ç«¯å…±äº«ç‰ˆï¼ˆæ— åœ°åŸŸé™åˆ¶ï¼Œæ‰€æœ‰äººå‡å¯è®¿é—®ï¼Œå®æ—¶åŒæ­¥ï¼‰
         * âœ… æ–¹æ¡ˆ2ï¼ˆå¤‡ç”¨ï¼‰ï¼šå±€åŸŸç½‘å…±äº«ç‰ˆï¼ˆæ— å¤–ç½‘å¯ç”¨ï¼ŒåŒä¸€å±€åŸŸç½‘å†…å¤šäººåŒæ­¥ï¼‰
         * âœ… æœ¬ä»£ç å·²å†…ç½®ã€Œæ— ç¼å…±äº«ã€èƒ½åŠ›ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼Œç›´æ¥ä½¿ç”¨ï¼
         */
        // è·å–æ‰€æœ‰å…±äº«æ•°æ®ï¼ˆç»Ÿä¸€å…¥å£ï¼Œä¿è¯æ•°æ®å”¯ä¸€ï¼‰
        function getAllShareData() {
            return JSON.parse(localStorage.getItem(SHARE_KEY)) || [];
        }

        // ========== âœ… æ ¸å¿ƒ3ï¼šä¸€é”®æ¸…ç©º/å¯¼å‡º/ç»Ÿè®¡å·¥å…·å‡½æ•° ==========
        // ä¸€é”®æ¸…ç©ºæ‰€æœ‰å…±äº«æ•°æ®
        function clearAllData() {
            if (confirm('âš ï¸ ç¡®è®¤æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯é€†ï¼Œå»ºè®®å…ˆå¯¼å‡ºå­˜æ¡£ï¼')) {
                localStorage.removeItem(SHARE_KEY);
                alert('âœ… æ‰€æœ‰æ•°æ®å·²æ¸…ç©ºï¼Œæ‰€æœ‰æˆå‘˜é¡µé¢å°†åŒæ­¥åˆ·æ–°');
                renderAllData();
            }
        }

        // ä¸€é”®å¯¼å‡ºExcelï¼ˆæ‰€æœ‰æ•°æ®å­˜æ¡£ï¼‰
        function exportExcel() {
            const allData = getAllShareData();
            if (allData.length === 0) { alert('âš ï¸ æš‚æ— æ•°æ®å¯å¯¼å‡ºï¼'); return; }
            // æ ¼å¼åŒ–å¯¼å‡ºæ•°æ®
            const exportData = allData.map((item, i) => ({
                åºå·: i+1,
                åˆåŒæ–¹å‘: item.dir,
                æ‰€å±åŸºåœ°: item.base,
                åˆåŒæ•°é‡: item.count,
                åˆåŒç±»å‹: item.type,
                æäº¤æ—¶é—´: item.time
            }));
            // ç”ŸæˆExcelæ–‡ä»¶å¹¶ä¸‹è½½
            const ws = XLSX.utils.json_to_sheet(exportData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "åŸºåœ°åˆåŒæ±‡æ€»æ•°æ®");
            XLSX.writeFile(wb, `åŸºåœ°åˆåŒæ±‡æ€»_${new Date().toLocaleDateString()}.xlsx`);
        }

        // æ•°æ®ç»Ÿè®¡å·¥å…·ï¼ˆæ€»æ•°ã€ç”³è¯·/å›æ”¶ã€åŸºåœ°ã€ç±»å‹ç»Ÿè®¡ï¼‰
        function calcStatistics(dataList) {
            const totalCount = dataList.reduce((sum, item) => sum + item.count, 0); // æ€»æ•°é‡
            const totalNum = dataList.length; // æ€»æ¡æ•°
            // ç”³è¯·/å›æ”¶ç»Ÿè®¡
            const dirCount = {
                ç”³è¯·åˆåŒ: dataList.filter(item => item.dir === "ç”³è¯·åˆåŒ").reduce((sum, item) => sum + item.count, 0),
                å›æ”¶åˆåŒ: dataList.filter(item => item.dir === "å›æ”¶åˆåŒ").reduce((sum, item) => sum + item.count, 0)
            };
            // åŸºåœ°ç»Ÿè®¡
            const baseCount = dataList.reduce((obj, item) => {
                obj[item.base] = (obj[item.base] || 0) + item.count; return obj;
            }, {});
            // ç±»å‹ç»Ÿè®¡
            const typeCount = dataList.reduce((obj, item) => {
                obj[item.type] = (obj[item.type] || 0) + item.count; return obj;
            }, {});
            return { totalNum, totalCount, dirCount, baseCount, typeCount };
        }

        // ========== âœ… æ ¸å¿ƒ4ï¼šæ—¶é—´ç­›é€‰ï¼ˆä»Šæ—¥/æœ¬å‘¨/æœ¬æœˆï¼‰ ==========
        function isToday(item) { const d = new Date(item.timestamp); return d.getFullYear() === TODAY.getFullYear() && d.getMonth() === TODAY.getMonth() && d.getDate() === TODAY.getDate(); }
        function isThisWeek(item) { const d = new Date(item.timestamp); const firstDay = new Date(TODAY.setDate(TODAY.getDate() - TODAY.getDay())); const lastDay = new Date(firstDay); lastDay.setDate(firstDay.getDate() +6); return item.timestamp >= firstDay.getTime() && item.timestamp <= lastDay.getTime(); }
        function isThisMonth(item) { const d = new Date(item.timestamp); return d.getFullYear() === TODAY.getFullYear() && d.getMonth() === TODAY.getMonth(); }

        // ========== âœ… æ ¸å¿ƒ5ï¼šæ¸²æŸ“æ‰€æœ‰æ•°æ®ï¼ˆæ˜ç»†+ç»Ÿè®¡ï¼Œå®æ—¶åˆ·æ–°ï¼‰ ==========
        function renderAllData() {
            const allData = getAllShareData();
            // ç­›é€‰ä¸‰çº§æ•°æ®
            const todayData = allData.filter(isToday);
            const weekData = allData.filter(isThisWeek);
            const monthData = allData.filter(isThisMonth);
            // è®¡ç®—ä¸‰çº§ç»Ÿè®¡
            const todayStat = calcStatistics(todayData);
            const weekStat = calcStatistics(weekData);
            const monthStat = calcStatistics(monthData);

            // æ¸²æŸ“ä»Šæ—¥æ•°æ®
            renderTodayData(todayData, todayStat);
            // æ¸²æŸ“æœ¬å‘¨æ•°æ®
            renderWeekData(weekStat);
            // æ¸²æŸ“æœ¬æœˆæ•°æ®
            renderMonthData(monthStat);
        }

        // ========== é¡µé¢æ¸²æŸ“å‡½æ•°ï¼ˆæ˜ç»†+ç»Ÿè®¡ï¼‰ ==========
        function renderTodayData(data, stat) {
            // ä»Šæ—¥ç»Ÿè®¡
            document.getElementById('todayStat').innerHTML = `
                <div class="stat-item">ä»Šæ—¥æ€»æ¡æ•°ï¼š<span class="stat-num">${stat.totalNum}</span> æ¡</div>
                <div class="stat-item">ä»Šæ—¥æ€»æ•°é‡ï¼š<span class="stat-num">${stat.totalCount}</span> ä»½</div>
                <div class="stat-item">ç”³è¯·åˆåŒï¼š<span class="stat-green">${stat.dirCount['ç”³è¯·åˆåŒ']}</span> ä»½</div>
                <div class="stat-item">å›æ”¶åˆåŒï¼š<span class="stat-red">${stat.dirCount['å›æ”¶åˆåŒ']}</span> ä»½</div>
            `;
            // ä»Šæ—¥æ˜ç»†
            const tbody = document.getElementById('todayTable');
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td class="table-td" colspan="6">ä»Šæ—¥æš‚æ— å½•å…¥æ•°æ®</td></tr>';
                return;
            }
            tbody.innerHTML = data.map((item, i) => `
                <tr class="${i%2===0?'bg-white':'bg-gray-50'}">
                    <td class="table-td">${i+1}</td>
                    <td class="table-td ${item.dir==='ç”³è¯·åˆåŒ'?'text-green-600':'text-red-600'} font-bold">${item.dir}</td>
                    <td class="table-td">${item.base}</td>
                    <td class="table-td font-bold">${item.count}</td>
                    <td class="table-td">${item.type}</td>
                    <td class="table-td">${item.time}</td>
                </tr>
            `).join('');
        }

        function renderWeekData(stat) {
            document.getElementById('weekStat').innerHTML = `
                <div class="stat-item">æœ¬å‘¨æ€»æ¡æ•°ï¼š<span class="stat-num">${stat.totalNum}</span> æ¡</div>
                <div class="stat-item">æœ¬å‘¨æ€»æ•°é‡ï¼š<span class="stat-num">${stat.totalCount}</span> ä»½</div>
            `;
            renderStatTable('weekBaseTable', stat.baseCount, 'åŸºåœ°', 'æ•°é‡');
            renderStatTable('weekTypeTable', stat.typeCount, 'ç±»å‹', 'æ•°é‡');
            renderStatTable('weekDirTable', stat.dirCount, 'æ–¹å‘', 'æ•°é‡');
        }

        function renderMonthData(stat) {
            document.getElementById('monthStat').innerHTML = `
                <div class="stat-item">æœ¬æœˆæ€»æ¡æ•°ï¼š<span class="stat-num">${stat.totalNum}</span> æ¡</div>
                <div class="stat-item">æœ¬æœˆæ€»æ•°é‡ï¼š<span class="stat-num">${stat.totalCount}</span> ä»½</div>
            `;
            renderStatTable('monthBaseTable', stat.baseCount, 'åŸºåœ°', 'æ•°é‡');
            renderStatTable('monthTypeTable', stat.typeCount, 'ç±»å‹', 'æ•°é‡');
            renderStatTable('monthDirTable', stat.dirCount, 'æ–¹å‘', 'æ•°é‡');
        }

        // é€šç”¨ç»Ÿè®¡è¡¨æ ¼æ¸²æŸ“
        function renderStatTable(id, data, t1, t2) {
            const table = document.getElementById(id);
            if (Object.keys(data).length === 0) {
                table.innerHTML = '<tr><td class="table-td" colspan="2">æš‚æ— æ•°æ®</td></tr>';
                return;
            }
            let html = `<thead><tr><th class="table-th">${t1}</th><th class="table-th">${t2}</th></tr></thead><tbody>`;
            for (const [k, v] of Object.entries(data)) {
                html += `<tr><td class="table-td">${k}</td><td class="table-td font-bold text-blue-600">${v}</td></tr>`;
            }
            table.innerHTML = html + '</tbody>';
        }
    </script>
</body>
</html>